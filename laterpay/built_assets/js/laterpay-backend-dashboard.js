!function(e){e(function(){function t(){var t,s,i={daysBack:8,itemsPerList:10,list:[],configurationSelection:e("#lp_js_selectDashboardInterval, #lp_js_selectRevenueModel"),selectedInterval:e("#lp_js_selectDashboardInterval"),selectedRevenueModel:e("#lp_js_selectRevenueModel"),previousInterval:e("#lp_js_loadPreviousInterval"),nextInterval:e("#lp_js_loadNextInterval"),conversionDiagram:e("#lp_js_conversionDiagram"),salesDiagram:e("#lp_js_salesDiagram"),revenueDiagram:e("#lp_js_revenueDiagram"),totalImpressionsKPI:e("#lp_js_totalImpressions"),avgConversionKPI:e("#lp_js_avgConversion"),newCustomersKPI:e("#lp_js_shareOfNewCustomers"),avgItemsSoldKPI:e("#lp_js_avg-items-sold"),totalItemsSoldKPI:e("#lp_js_total-items-sold"),avgRevenueKPI:e("#lp_js_avgRevenue"),totalRevenueKPI:e("#lp_js_totalRevenue"),bestConvertingList:e("#lp_js_bestConvertingList"),leastConvertingList:e("#lp_js_leastConvertingList"),bestSellingList:e("#lp_js_bestSellingList"),leastSellingList:e("#lp_js_leastSellingList"),bestGrossingList:e("#lp_js_bestGrossingList"),leastGrossingList:e("#lp_js_leastGrossingList")},l=function(){e("#lp_js_refreshDashboard").click(function(e){c(),e.preventDefault()}),i.configurationSelection.change(function(){c()}),i.nextInterval.mousedown(function(){}).click(function(e){e.preventDefault()}),i.previousInterval.mousedown(function(){}).click(function(e){e.preventDefault()})},o=function(s){var l=s.converting_items_by_day.x,o=[];for(t=0;t<i.daysBack;t++)o.push([t+1,100]);e.plot(i.conversionDiagram,[{data:o,bars:{show:!0,barWidth:.7,fillColor:"#e3e3e3",lineWidth:0,align:"center",horizontal:!1}},{data:s.converting_items_by_day.y,bars:{show:!0,barWidth:.35,fillColor:"#50C371",lineWidth:0,align:"center",horizontal:!1}}],{legend:{show:!1},xaxis:{font:{color:"#bbb",lineHeight:18},show:!0,ticks:l},yaxis:{font:{color:"#bbb"},ticks:5,tickFormatter:function(e){return e+" %"},min:0,max:100,reserveSpace:!0},series:{shadowSize:0},grid:{borderWidth:{top:0,right:0,bottom:1,left:0},borderColor:"#ccc",tickColor:"rgba(247,247,247,0)"}}),e.plot(i.salesDiagram,[{data:s.selling_items_by_day.y,color:"#50C371",lines:{show:!0,lineWidth:1.5,fill:!1,gaps:!0},points:{show:!0,radius:3,lineWidth:0,fill:!0,fillColor:"#50C371"}}],{legend:{show:!1},xaxis:{font:{color:"#bbb",lineHeight:18},show:!0,ticks:l},yaxis:{font:{color:"#bbb"},ticks:5,min:0,max:1e3,reserveSpace:!0},series:{shadowSize:0},grid:{borderWidth:{top:0,right:0,bottom:1,left:0},borderColor:"#ccc",tickColor:"rgba(247,247,247,0)"}}),e.plot(i.revenueDiagram,[{data:s.revenue_items_by_day.y,color:"#50C371",lines:{show:!0,lineWidth:1.5,fill:!1,gaps:!0},points:{show:!0,radius:3,lineWidth:0,fill:!0,fillColor:"#50C371"}}],{legend:{show:!1},xaxis:{font:{color:"#bbb",lineHeight:18},show:!0,ticks:l},yaxis:{font:{color:"#bbb"},ticks:5,min:0,max:1e3,reserveSpace:!0},series:{shadowSize:0},grid:{borderWidth:{top:0,right:0,bottom:1,left:0},borderColor:"#ccc",tickColor:"rgba(247,247,247,0)"}}),i.totalImpressionsKPI.text(s.impressions||0),i.avgConversionKPI.text(s.conversion||0),i.newCustomersKPI.text(s.new_customers||0),i.avgItemsSoldKPI.text(s.avg_purchase||0),i.totalItemsSoldKPI.text(s.total_items_sold||0),i.avgRevenueKPI.text(s.avg_revenue||0),i.totalRevenueKPI.text(s.total_revenue||0),n(i.bestConvertingList,s.best_converting_items),n(i.leastConvertingList,s.least_converting_items),n(i.bestSellingList,s.most_selling_items),n(i.leastSellingList,s.least_selling_items),n(i.bestGrossingList,s.most_revenue_items),n(i.leastGrossingList,s.least_revenue_items),r()},n=function(e,l){if(i.list=[],t=0,s=l.length,s>0)for(;s>t;t++)i.list.push(a(l[t].post_id,l[t].post_title,l[t].amount,l[t].unit,l[t].sparkline));else i.list=["<dfn>"+lpVars.i18n.noData+"</dfn>"];e.html(i.list.join(""))},a=function(e,t,s,i,l){var o=i?s+"<small>"+i+"</small>":s;return'<li><span class="lp_sparklineBar">'+l+'</span><strong class="lp_value">'+o+'</strong><i><a href="#" class="lp_js_toggleItemDetails">'+t+"</a></i></li>"},r=function(){e(".lp_sparklineBar").peity("bar",{width:34,height:14,gap:1,fill:function(){return"#ccc"}})},c=function(){var t=e(i.selectedInterval).find(":checked").val(),s=i.selectedRevenueModel.find(":checked").val();e.post(lpVars.ajaxUrl,{action:"laterpay_get_dashboard_data",_wpnonce:lpVars.nonces.dashboard,interval:t,revenue_model:s,days:i.daysBack,count:i.itemsPerList,refresh:1},function(e){e.success&&o(e.data)},"json")},_=function(){l(),o(lpVars.data)};_()}t()})}(jQuery);